"use strict";(self.webpackChunkembedding_sdk_docs=self.webpackChunkembedding_sdk_docs||[]).push([[7770],{9252:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>o});var i=t(5893),r=t(1151);const s={title:"Retrieve and apply filters",description:"Filters can be applied both during the execution of an embedded dossier and after it has been rendered."},l=void 0,a={id:"native-embedding-architecture/apply-filter",title:"Retrieve and apply filters",description:"Filters can be applied both during the execution of an embedded dossier and after it has been rendered.",source:"@site/docs/native-embedding-architecture/apply-filter.md",sourceDirName:"native-embedding-architecture",slug:"/native-embedding-architecture/apply-filter",permalink:"/embedding-sdk-docs/native-embedding-architecture/apply-filter",draft:!1,unlisted:!1,editUrl:"https://github.com/MicroStrategy/embedding-sdk-docs/tree/public/docs/native-embedding-architecture/apply-filter.md",tags:[],version:"current",lastUpdatedBy:"Aran0011",lastUpdatedAt:1705984794,formattedLastUpdatedAt:"Jan 23, 2024",frontMatter:{title:"Retrieve and apply filters",description:"Filters can be applied both during the execution of an embedded dossier and after it has been rendered."},sidebar:"tutorialSidebar",previous:{title:"Getting dossier info via APIs",permalink:"/embedding-sdk-docs/native-embedding-architecture/dossier-info-api"},next:{title:"Add event handling",permalink:"/embedding-sdk-docs/native-embedding-architecture/event-handling"}},d={},o=[{value:"Get available filter elements",id:"get-available-filter-elements",level:2},{value:"<code>MstrDossier.getFilterAvailableElements</code> examples",id:"mstrdossiergetfilteravailableelements-examples",level:3},{value:"Apply filters after embedded visualizations are rendered",id:"apply-filters-after-embedded-visualizations-are-rendered",level:2},{value:"Filter types and filter details",id:"filter-types-and-filter-details",level:3},{value:"Chapter-level filters",id:"chapter-level-filters",level:4},{value:"On-Page selectors",id:"on-page-selectors",level:4},{value:"Visualizations used as filters",id:"visualizations-used-as-filters",level:4},{value:"<code>MstrDossier.applyFilter</code> examples",id:"mstrdossierapplyfilter-examples",level:3},{value:"Chapter-Level filters",id:"chapter-level-filters-1",level:4},{value:"On-Page selectors",id:"on-page-selectors-1",level:4},{value:"Visualizations used as filters",id:"visualizations-used-as-filters-1",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components},{Available:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Available",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t,{since:"2021 Update 9 (May 2023)"}),"\n",(0,i.jsxs)(n.p,{children:["Filters can be applied both during the execution of an embedded dossier and after it has been rendered. After using ",(0,i.jsx)(n.a,{href:"/embedding-sdk-docs/native-embedding-architecture/embed-multiple-viz",children:"Native Embedding SDK"})," to embed multiple visualizations in a client's webpage, you can manipulate the chapter-level filters, on-page selectors, and visualizations used as filters via the Native Embedding SDK available since 2021 Update 9. For chapter-level filters and on-page selectors, MicroStrategy only supports attribute element list selectors."]}),"\n",(0,i.jsxs)(n.p,{children:["Let's say you already have the ",(0,i.jsx)(n.code,{children:"MstrEnvironment"})," and ",(0,i.jsx)(n.code,{children:"MstrDossier"})," objects:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  const mstrEnvironment = await microstrategy.embeddingComponent.environments.create({\n    serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n    getAuthToken: () => {\n      // Logic similar to the existing Native Embedding SDK, but only standard auth login is allowed\n    },\n  });\n  const mstrDossier = await mstrEnvironment.loadDossier({\n    projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n    objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  });\n  await mstrDossier.refresh([\n    {\n      key: "K66",\n      container: document.getElementById("container1"),\n    },\n  ]);\n  // Your custom logic\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"get-available-filter-elements",children:"Get available filter elements"}),"\n",(0,i.jsxs)(n.p,{children:["To apply filters to the dossier, the client may need to get the list of available attribute elements of the filters or selectors. You can use the ",(0,i.jsx)(n.code,{children:"MstrDossier.getFilterAvailableElements()"})," function in the Native Embedding SDK to retrieve the available attribute elements of the filters or selectors."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.code,{children:"getFilterAvailableElements()"})}),(0,i.jsx)(n.th,{})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Class"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MstrDossier"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Return Type"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Promise<AttributeElement[]>"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Description"}),(0,i.jsx)(n.td,{children:"Get the attribute element list of the filter or selector"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Example"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"mstrDossier.getFilterAvailableElements()"})})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"mstrdossiergetfilteravailableelements-examples",children:[(0,i.jsx)(n.code,{children:"MstrDossier.getFilterAvailableElements"})," examples"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.getFilterAvailableElements({\n    filterKey: "W67", // filter key\n    searchPattern: "o", // pattern to match with the element list, optional\n    offset: 0, // optional\n    limit: 100, // optional\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Example of the attribute element list in the resolved value:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "name": "Books",\n    "id": "h1;;Books"\n  },\n  {\n    "name": "Electronics",\n    "id": "h2;;Electronics"\n  }\n]\n'})}),"\n",(0,i.jsx)(n.h2,{id:"apply-filters-after-embedded-visualizations-are-rendered",children:"Apply filters after embedded visualizations are rendered"}),"\n",(0,i.jsxs)(n.p,{children:["After embedded visualizations have been rendered, you can use the\xa0",(0,i.jsx)(n.code,{children:"MstrDossier.getDossierDefinition()"}),"\xa0function in the Native Embedding SDK\xa0to retrieve information about filters, selectors, and visualizations used as filters in the dossier. After you have the key of the filter, selector, or visualization used as a filter, you can use the ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," function to manipulate it."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"For filters and selectors, we currently only support manipulating the selector type of the attribute element list."})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.code,{children:"applyFilter()"})}),(0,i.jsx)(n.th,{})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Class"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MstrDossier"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Parameter"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"FilterSelectionDefinition"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Return Type"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Promise<void>"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Description"}),(0,i.jsx)(n.td,{children:"Apply filters with the selection in the input"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Example"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"mstrDossier.applyFilter()"})})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"filter-types-and-filter-details",children:"Filter types and filter details"}),"\n",(0,i.jsx)(n.p,{children:"The sections below show the filter details for each filter type."}),"\n",(0,i.jsx)(n.h4,{id:"chapter-level-filters",children:"Chapter-level filters"}),"\n",(0,i.jsxs)(n.p,{children:["For the chapter-level filter with an ",(0,i.jsx)(n.code,{children:"attribute_element_list"})," type, you can get its key and source attribute definition from the dossier definition with the ",(0,i.jsx)(n.code,{children:"MstrDossier.getDossierDefinition()"})," function. Then you can manipulate the filter with the ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," function as follows. After the function successfully returns, all embedded visualizations on the same chapter as the filter are refreshed to reflect the latest data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"try {\n  await mstrDossier.applyFilter({\n    key: `${filterKey}`,\n    currentSelection: {\n      selectionStatus: \"<string>\", // optional, values: ['unfiltered', 'included', 'excluded'], default: 'included'\n      allSelected: \"<boolean>\", // optional, default: false,\n      elements: [\n        {\n          id: \"<string>\", // attribute element id, required\n          name: \"<string>\", // attribute element name, optional\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"on-page-selectors",children:"On-Page selectors"}),"\n",(0,i.jsxs)(n.p,{children:["For on-page selectors with an ",(0,i.jsx)(n.code,{children:"attribute_element_list"})," type, you can get its key from the dossier definition and source attribute definition with the ",(0,i.jsx)(n.code,{children:"MstrDossier.getDossierDefinition()"})," function. Then you can manipulate the filter with the ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," function as follows. After the function successfully returns, all embedded visualizations that are the targets of the selector are refreshed to reflect the latest data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"try {\n  await mstrDossier.applyFilter({\n    key: `${selectorKey}`,\n    currentSelection: {\n      selectionStatus: \"<string>\", // optional, values: ['unfiltered', 'included', 'excluded'], default: 'included'\n      allSelected: \"<boolean>\", // optional, default: false,\n      elements: [\n        {\n          id: \"<string>\", // attribute element id, required\n          name: \"<string>\", // attribute element name, optional\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"visualizations-used-as-filters",children:"Visualizations used as filters"}),"\n",(0,i.jsxs)(n.p,{children:["For a visualization used as a filter, you need its key from the dossier definition with the ",(0,i.jsx)(n.code,{children:"MstrDossier.getDossierDefinition()"})," function. Then you can manipulate the visualization used as a filter with ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," function as follows. After the function successfully returns, the elements of the visualization used as a filter are highlighted accordingly, and all embedded visualizations that are the targets of the visualization as the filter are refreshed to reflect the latest data."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"attribute element selection"}),"\n",(0,i.jsxs)(n.p,{children:["To select multiple attribute elements in the visualizations used as filters, you can use ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," with the following input:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: `${visualizationKey}`,\n    currentSelection: {\n      selectionStatus: "included", // optional\n      type: "attribute_element_list", // required\n      selections: [\n        {\n          attribute: {\n            id: "<string>", // attribute id, required\n            name: "<string>", // attribute name, optional\n          },\n          elements: [\n            {\n              id: "<string>", // attribute element id, required\n              name: "<string>", // attribute element name, optional\n            },\n          ],\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"metric element selection"}),"\n",(0,i.jsxs)(n.p,{children:["To select multiple metric elements in the visualizations used as filters, you need to provide the full list of attributes in the visualization and every metric element selection should be the combination of attribute elements from every attribute. You can use ",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," with the following input:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: `${visualizationKey}`,\n    currentSelection: {\n      selectionStatus: "included", // optional\n      type: "metric_element_list", // required\n      attributes: [\n        // should be the same list as all attributes in the visualization\n        {\n          id: "<string>", // attribute id, required\n          name: "<string>", // attribute name, optional\n        },\n      ],\n      selections: [\n        [\n          // one metric element selection\n          {\n            id: "<string>", // attribute element id, required\n            name: "<string>", // attribute element name, optional\n          },\n        ],\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"mstrdossierapplyfilter-examples",children:[(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter"})," examples"]}),"\n",(0,i.jsxs)(n.p,{children:["Here are some examples for the filter object in the\xa0",(0,i.jsx)(n.code,{children:"MstrDossier.applyFilter()"})," function parameter:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#chapter-level-filters",children:"Chapter-Level filters"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#on-page-selectors",children:"On-Page selectors"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#visualizations-used-as-filters",children:"Visualizations used as filters"})}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"chapter-level-filters-1",children:"Chapter-Level filters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select the element list of the filter"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W87",\n    currentSelection: {\n      elements: [\n        {\n          id: "<string>",\n          name: "<string>",\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select all elements of the filter"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W87",\n    currentSelection: {\n      allSelected: true,\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Unset the filter selection."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W87",\n    currentSelection: {\n      selectionStatus: "unfiltered",\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"on-page-selectors-1",children:"On-Page selectors"}),"\n",(0,i.jsx)(n.p,{children:"To apply selections to on-page selectors, use the same input as chapter-level filters."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select the element list of the selector"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W76",\n    currentSelection: {\n      elements: [\n        {\n          id: "<string>",\n          name: "<string>",\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select all elements of the selector"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W76",\n    currentSelection: {\n      allSelected: true,\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Unset the selection of the selector"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "W76",\n    currentSelection: {\n      selectionStatus: "unfiltered",\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"visualizations-used-as-filters-1",children:"Visualizations used as filters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Select attribute elements of the visualization"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Select the ",(0,i.jsx)(n.code,{children:"June, April"})," elements of the ",(0,i.jsx)(n.code,{children:"Month of Year"})," attribute and the ",(0,i.jsx)(n.code,{children:"2014"})," element of the ",(0,i.jsx)(n.code,{children:"Year"})," attribute."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "K52",\n    currentSelection: {\n      selectionStatus: "included",\n      type: "attribute_element_list",\n      selections: [\n        {\n          attribute: {\n            id: "8D679D4511D3E4981000E787EC6DE8A4",\n            name: "Month of Year",\n          },\n          elements: [\n            {\n              id: "h6;8D679D4511D3E4981000E787EC6DE8A4",\n              name: "June",\n            },\n            {\n              id: "h4;8D679D4511D3E4981000E787EC6DE8A4",\n              name: "April",\n            },\n          ],\n        },\n        {\n          attribute: {\n            id: "8D679D5111D3E4981000E787EC6DE8A4",\n            name: "Year",\n          },\n          elements: [\n            {\n              id: "h2014;8D679D5111D3E4981000E787EC6DE8A4",\n              name: "2014",\n            },\n          ],\n        },\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select metric elements of the visualization"}),"\n",(0,i.jsxs)(n.p,{children:["Select metric elements identified by the ",(0,i.jsx)(n.code,{children:"June,2014"})," and ",(0,i.jsx)(n.code,{children:"September,2014"})," attribute elements."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "K52",\n    currentSelection: {\n      selectionStatus: "included",\n      type: "metric_element_list",\n      attributes: [\n        {\n          id: "8D679D4511D3E4981000E787EC6DE8A4",\n          name: "Month of Year",\n        },\n        {\n          id: "8D679D5111D3E4981000E787EC6DE8A4",\n          name: "Year",\n        },\n      ],\n      selections: [\n        [\n          {\n            id: "h6;8D679D4511D3E4981000E787EC6DE8A4",\n            name: "June",\n          },\n          {\n            id: "h2014;8D679D5111D3E4981000E787EC6DE8A4",\n            name: "2014",\n          },\n        ],\n        [\n          {\n            id: "h9;8D679D4511D3E4981000E787EC6DE8A4",\n            name: "September",\n          },\n          {\n            id: "h2014;8D679D5111D3E4981000E787EC6DE8A4",\n            name: "2014",\n          },\n        ],\n      ],\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Clear the element selections of the visualization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'try {\n  await mstrDossier.applyFilter({\n    key: "K52",\n    currentSelection: {\n      selectionStatus: "unfiltered",\n    },\n  });\n} catch (error) {\n  // Your own error handling code\n}\n'})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>l});var i=t(7294);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);