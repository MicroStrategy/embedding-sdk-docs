"use strict";(self.webpackChunkembedding_sdk_docs=self.webpackChunkembedding_sdk_docs||[]).push([[2475],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var d=r.createContext({}),p=function(e){var t=r.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(d.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,d=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,h=c["".concat(d,".").concat(m)]||c[m]||s[m]||o;return n?r.createElement(h,i(i({ref:t},u),{},{components:n})):r.createElement(h,i({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=c;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1083:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return d},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return s}});var r=n(3117),a=n(102),o=(n(7294),n(3905)),i=["components"],l={title:"Properties for an embedded MicroStrategy bot consumption page",description:"Describes the properties that can be set for an embedded MicroStrategy bot consumption page."},d=void 0,p={unversionedId:"embed-bot-consumption-page/embed-bot-consumption-properties",id:"embed-bot-consumption-page/embed-bot-consumption-properties",title:"Properties for an embedded MicroStrategy bot consumption page",description:"Describes the properties that can be set for an embedded MicroStrategy bot consumption page.",source:"@site/docs/embed-bot-consumption-page/embed-bot-consumption-properties.md",sourceDirName:"embed-bot-consumption-page",slug:"/embed-bot-consumption-page/embed-bot-consumption-properties",permalink:"/embedding-sdk-docs/embed-bot-consumption-page/embed-bot-consumption-properties",draft:!1,editUrl:"https://github.com/MicroStrategy/embedding-sdk-docs/tree/public/docs/embed-bot-consumption-page/embed-bot-consumption-properties.md",tags:[],version:"current",lastUpdatedBy:"Darren Holmblad",lastUpdatedAt:1702664682,formattedLastUpdatedAt:"Dec 15, 2023",frontMatter:{title:"Properties for an embedded MicroStrategy bot consumption page",description:"Describes the properties that can be set for an embedded MicroStrategy bot consumption page."},sidebar:"tutorialSidebar",previous:{title:"Embed MicroStrategy bot consumption page",permalink:"/embedding-sdk-docs/embed-bot-consumption-page/"},next:{title:"Embed MicroStrategy report page",permalink:"/embedding-sdk-docs/embed-report-page/"}},u={},s=[{value:"Method",id:"method",level:2},{value:"<code>microstrategy.embeddingContexts.embedBotConsumptionPage(props)</code>",id:"microstrategyembeddingcontextsembedbotconsumptionpageprops",level:3},{value:"Return value",id:"return-value",level:4},{value:"Input parameters",id:"input-parameters",level:4},{value:"Properties",id:"properties",level:2},{value:"<code>placeholder</code>",id:"placeholder",level:3},{value:"Required?",id:"required",level:4},{value:"Default value",id:"default-value",level:4},{value:"Sample",id:"sample",level:4},{value:"<code>serverUrl</code>, <code>projectId</code>, <code>objectId</code>",id:"serverurl-projectid-objectid",level:3},{value:"Required?",id:"required-1",level:4},{value:"Default value",id:"default-value-1",level:4},{value:"Sample",id:"sample-1",level:4},{value:"<code>customApplicationId</code>, <code>pageKey</code>",id:"customapplicationid-pagekey",level:3},{value:"Required?",id:"required-2",level:4},{value:"Default value",id:"default-value-2",level:4},{value:"Sample",id:"sample-2",level:4},{value:"<code>containerHeight</code>",id:"containerheight",level:3},{value:"Required?",id:"required-3",level:4},{value:"Default value",id:"default-value-3",level:4},{value:"Sample",id:"sample-3",level:4},{value:"<code>containerWidth</code>",id:"containerwidth",level:3},{value:"Required?",id:"required-4",level:4},{value:"Default value",id:"default-value-4",level:4},{value:"Sample",id:"sample-4",level:4},{value:"<code>enableCustomAuthentication</code>",id:"enablecustomauthentication",level:3},{value:"Required?",id:"required-5",level:4},{value:"Default value",id:"default-value-5",level:4},{value:"Sample",id:"sample-5",level:4},{value:"<code>customAuthenticationType</code>",id:"customauthenticationtype",level:3},{value:"Required?",id:"required-6",level:4},{value:"Default value",id:"default-value-6",level:4},{value:"Sample",id:"sample-6",level:4},{value:"<code>getLoginToken</code>",id:"getlogintoken",level:3},{value:"Required?",id:"required-7",level:4},{value:"Default value",id:"default-value-7",level:4},{value:"Sample",id:"sample-7",level:4},{value:"<code>disableCustomErrorHandlerOnCreate</code>",id:"disablecustomerrorhandleroncreate",level:3},{value:"Required?",id:"required-8",level:4},{value:"Default value",id:"default-value-8",level:4},{value:"Sample",id:"sample-8",level:4},{value:"<code>errorHandler</code>",id:"errorhandler",level:3},{value:"Required?",id:"required-9",level:4},{value:"Default value",id:"default-value-9",level:4},{value:"Sample",id:"sample-9",level:4},{value:"<code>sessionErrorHandler</code>",id:"sessionerrorhandler",level:3},{value:"Required?",id:"required-10",level:4},{value:"Default value",id:"default-value-10",level:4},{value:"Sample",id:"sample-10",level:4},{value:"<code>customUi</code>",id:"customui",level:3},{value:"Properties",id:"properties-1",level:4},{value:"<code>addToLibraryBanner</code>",id:"addtolibrarybanner",level:5},{value:"<code>botConsumption</code>",id:"botconsumption",level:5},{value:"Sample",id:"sample-11",level:4},{value:"<code>permissions</code>",id:"permissions",level:3},{value:"Required?",id:"required-11",level:4},{value:"Properties",id:"properties-2",level:4},{value:"<code>allowClipboardWrite</code>",id:"allowclipboardwrite",level:5},{value:"Default value",id:"default-value-11",level:5},{value:"Sample",id:"sample-12",level:4}],c={toc:s};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"When you embed a MicroStrategy bot consumption page into a web page, you use the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"embedBotConsumptionPage(props)"),"\xa0method under the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"microstrategy.embeddingContexts"),"\xa0namespace."),(0,o.kt)("h2",{id:"method"},"Method"),(0,o.kt)("h3",{id:"microstrategyembeddingcontextsembedbotconsumptionpageprops"},(0,o.kt)("inlineCode",{parentName:"h3"},"microstrategy.embeddingContexts.embedBotConsumptionPage(props)")),(0,o.kt)("p",null,"This method creates an iFrame on the web page (in the location specified by the ",(0,o.kt)("inlineCode",{parentName:"p"},"placeholder")," property) and inserts a link to the MicroStrategy bot consumption page URL (specified by the ",(0,o.kt)("inlineCode",{parentName:"p"},"serverUrl")," property)."),(0,o.kt)("h4",{id:"return-value"},"Return value"),(0,o.kt)("p",null,"This method returns a promise, which is resolved when the MicroStrategy bot consumption page is loaded."),(0,o.kt)("h4",{id:"input-parameters"},"Input parameters"),(0,o.kt)("p",null,"The\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"props"),"\xa0parameter contains required key:value pairs that defines the Library Server URL and the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"<div>"),"\xa0placeholder where the iFrame containing the MicroStrategy bot consumption page will be created. It can also contain other optional key:value pairs to customize the UI, authentication and custom error handler."),(0,o.kt)("p",null,"The\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"props"),"\xa0parameter could contain the following key:value pairs:"),(0,o.kt)("h2",{id:"properties"},"Properties"),(0,o.kt)("h3",{id:"placeholder"},(0,o.kt)("inlineCode",{parentName:"h3"},"placeholder")),(0,o.kt)("p",null,"Reference for the container ",(0,o.kt)("inlineCode",{parentName:"p"},"<div>"),"."),(0,o.kt)("h4",{id:"required"},"Required?"),(0,o.kt)("p",null,"Yes"),(0,o.kt)("h4",{id:"default-value"},"Default value"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h4",{id:"sample"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n});\n')),(0,o.kt)("h3",{id:"serverurl-projectid-objectid"},(0,o.kt)("inlineCode",{parentName:"h3"},"serverUrl"),", ",(0,o.kt)("inlineCode",{parentName:"h3"},"projectId"),", ",(0,o.kt)("inlineCode",{parentName:"h3"},"objectId")),(0,o.kt)("p",null,"The required parameters in the bot URL."),(0,o.kt)("p",null,"These properties build the full report page URL to be embedded.\nThe Embedding SDK builds the URL using ",(0,o.kt)("inlineCode",{parentName:"p"},"serverUrl")," + '/app/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"projectId")," + '/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"objectId")," + '/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"pageKey"),"."),(0,o.kt)("h4",{id:"required-1"},"Required?"),(0,o.kt)("p",null,"Yes"),(0,o.kt)("h4",{id:"default-value-1"},"Default value"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h4",{id:"sample-1"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n});\n')),(0,o.kt)("h3",{id:"customapplicationid-pagekey"},(0,o.kt)("inlineCode",{parentName:"h3"},"customApplicationId"),", ",(0,o.kt)("inlineCode",{parentName:"h3"},"pageKey")),(0,o.kt)("p",null,"The optional parameters in the bot URL."),(0,o.kt)("p",null,"Specifies the application and page that the user wants to show in the embedded page."),(0,o.kt)("p",null,"When these parameters are specified, the embeded page URL would become ",(0,o.kt)("inlineCode",{parentName:"p"},"serverUrl")," + '/app/config/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"customApplicationId")," + '/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"projectId")," + '/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"objectId")," + '/' + ",(0,o.kt)("inlineCode",{parentName:"p"},"pageKey"),"."),(0,o.kt)("h4",{id:"required-2"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-2"},"Default value"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h4",{id:"sample-2"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  customApplicationId: "2AAC5EA4C57449FE9C0F69FE751DCFDB",\n  pageKey: "K53--K46",\n});\n')),(0,o.kt)("h3",{id:"containerheight"},(0,o.kt)("inlineCode",{parentName:"h3"},"containerHeight")),(0,o.kt)("p",null,"Sets the height of the placeholder."),(0,o.kt)("p",null,"If the style of the placeholder has a height value, the containerHeight property is ignored."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"containerHeight"),' property is applied as a style: style="height: $(containerHeight)".'),(0,o.kt)("h4",{id:"required-3"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-3"},"Default value"),(0,o.kt)("p",null,"600px"),(0,o.kt)("h4",{id:"sample-3"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  containerHeight: "600px",\n});\n')),(0,o.kt)("h3",{id:"containerwidth"},(0,o.kt)("inlineCode",{parentName:"h3"},"containerWidth")),(0,o.kt)("p",null,"Sets the width of the placeholder."),(0,o.kt)("p",null,"If the style of the placeholder has a width value, the containerWidth property is ignored."),(0,o.kt)("h4",{id:"required-4"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-4"},"Default value"),(0,o.kt)("p",null,"800px"),(0,o.kt)("h4",{id:"sample-4"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  containerWidth: "800px",\n});\n')),(0,o.kt)("h3",{id:"enablecustomauthentication"},(0,o.kt)("inlineCode",{parentName:"h3"},"enableCustomAuthentication")),(0,o.kt)("p",null,"Specifies whether custom authentication is enabled."),(0,o.kt)("h4",{id:"required-5"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-5"},"Default value"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("p",null,"User needs to log in from the default login page."),(0,o.kt)("h4",{id:"sample-5"},"Sample"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h3",{id:"customauthenticationtype"},(0,o.kt)("inlineCode",{parentName:"h3"},"customAuthenticationType")),(0,o.kt)("p",null,"Specifies the token type returned by the ",(0,o.kt)("inlineCode",{parentName:"p"},"getLoginToken")," function. There are two possible values, which can be provided by the CustomAuthenticationType enumeration."),(0,o.kt)("h4",{id:"required-6"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-6"},"Default value"),(0,o.kt)("p",null,"microstrategy.bot.CustomAuthenticationType.IDENTITY_TOKEN"),(0,o.kt)("h4",{id:"sample-6"},"Sample"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h3",{id:"getlogintoken"},(0,o.kt)("inlineCode",{parentName:"h3"},"getLoginToken")),(0,o.kt)("p",null,"Specifies a function that returns a promise, which is resolved with either authorization token (",(0,o.kt)("inlineCode",{parentName:"p"},"authToken"),") or the identity token (",(0,o.kt)("inlineCode",{parentName:"p"},"identityToken"),") The token type is specified by the customAuthenticationType property."),(0,o.kt)("h4",{id:"required-7"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-7"},"Default value"),(0,o.kt)("p",null,"See the sample code in the next column for the default implementation of this function."),(0,o.kt)("h4",{id:"sample-7"},"Sample"),(0,o.kt)("p",null,"When ",(0,o.kt)("inlineCode",{parentName:"p"},"customAuthenticationType")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"CustomAuthenticationType.AUTH_TOKEN"),", the following sample demonstrates how to send a fetch request to get ",(0,o.kt)("inlineCode",{parentName:"p"},"authToken")," with your credentials. You can do this using an ",(0,o.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),", if your browser does not support ",(0,o.kt)("inlineCode",{parentName:"p"},"fetch"),"."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"getLoginToken")," function can be found in ",(0,o.kt)("a",{parentName:"p",href:"../add-functionality/methods-and-properties#getlogintoken"},"the ",(0,o.kt)("inlineCode",{parentName:"a"},"getLoginToken")," doc")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  placeholder: document.getElementById("container"),\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  enableCustomerAuthentication: true,\n  customAuthenticationType: microstrategy.bot.CustomAuthenticationType.AUTH_TOKEN,\n  // The following function is the default implementation. User can provide custom implementation.\n  getLoginToken() {\n    // The similar logic as getLoginToken in existing Embedding SDK\n  },\n});\n')),(0,o.kt)("p",null,"When ",(0,o.kt)("inlineCode",{parentName:"p"},"customAuthenticationType")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"CustomAuthenticationType.IDENTITY_TOKEN"),", you need to add a component to your web server. Refer to Use Custom Authentication for more information."),(0,o.kt)("h3",{id:"disablecustomerrorhandleroncreate"},(0,o.kt)("inlineCode",{parentName:"h3"},"disableCustomErrorHandlerOnCreate")),(0,o.kt)("p",null,"To disable the custom error handler, set ",(0,o.kt)("inlineCode",{parentName:"p"},"disableCustomErrorHandlerOnCreate")," to true."),(0,o.kt)("p",null,"If this flag is set, all the errors occur in the initial loading process and manual actions would be handled by OOTB Library itself, an error dialog would pop up."),(0,o.kt)("p",null,"You could also refer to ",(0,o.kt)("a",{parentName:"p",href:"/embedding-sdk-docs/add-functionality/error-handling#custom-error-handling-during-bot-creation"},"Custom error handling during bot creation"),"."),(0,o.kt)("h4",{id:"required-8"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-8"},"Default value"),(0,o.kt)("p",null,"false"),(0,o.kt)("h4",{id:"sample-8"},"Sample"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h3",{id:"errorhandler"},(0,o.kt)("inlineCode",{parentName:"h3"},"errorHandler")),(0,o.kt)("p",null,"The custom error handler that executes when the error occurs in the initial loading process. It's a callback function that contains one parameter, ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),". The error object has the property ",(0,o.kt)("inlineCode",{parentName:"p"},"message"),", which contains the detailed error message."),(0,o.kt)("p",null,"Whether ",(0,o.kt)("inlineCode",{parentName:"p"},"errorHandler")," is set, the error occured inside the embeded page would output an error in the browser console. The detailed behavior could be seen in ",(0,o.kt)("a",{parentName:"p",href:"/embedding-sdk-docs/add-functionality/error-handling#the-overall-microstrategy-library-error-behavior-in-embed-case"},"The overall MicroStrategy Library error behavior in embed case"),"."),(0,o.kt)("h4",{id:"required-9"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-9"},"Default value"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h4",{id:"sample-9"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  placeholder: document.getElementById("container"),\n  errorHandler: (error) => {\n    console.log(`catch error during creation: ${error.message}`);\n    // Do something to handle the error\n  },\n});\n')),(0,o.kt)("h3",{id:"sessionerrorhandler"},(0,o.kt)("inlineCode",{parentName:"h3"},"sessionErrorHandler")),(0,o.kt)("p",null,"The custom error handler that executes when an session expiration error occurs. It's a callback function that contains one parameter, ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),". The error object has the property ",(0,o.kt)("inlineCode",{parentName:"p"},"message"),", which contains the detailed error message."),(0,o.kt)("p",null,"When session expires:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If ",(0,o.kt)("inlineCode",{parentName:"li"},"sessionErrorHandler")," is not set, the embedded page would redirect to the OOTB library login page."),(0,o.kt)("li",{parentName:"ul"},"If ",(0,o.kt)("inlineCode",{parentName:"li"},"sessionErrorHandler")," is set, the session error handler would be triggered and the embedded page would not change for 1 minute. If after 1 minute, the error handler doesn't do anything(like reauthentication and refresh page) to renew the session, the embedded page would redirect to the OOTB Library login page.")),(0,o.kt)("h4",{id:"required-10"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"default-value-10"},"Default value"),(0,o.kt)("p",null,"N/A"),(0,o.kt)("h4",{id:"sample-10"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  placeholder: document.getElementById("container"),\n  sessionErrorHandler: (error) => {\n    console.log(`catch session error: ${error.message}`);\n    // Do something to handle the error\n  },\n});\n')),(0,o.kt)("h3",{id:"customui"},(0,o.kt)("inlineCode",{parentName:"h3"},"customUi")),(0,o.kt)("p",null,"Specifies the custom UI settings on the embedded pages, including MicroStrategy Library home page, bot consumption page\uff0cbot authoring page, and report consumption page."),(0,o.kt)("h4",{id:"properties-1"},"Properties"),(0,o.kt)("h5",{id:"addtolibrarybanner"},(0,o.kt)("inlineCode",{parentName:"h5"},"addToLibraryBanner")),(0,o.kt)("p",null,"Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"addToLibraryBanner"),' object to customize the "Add To Library" banner on the MicroStrategy bot consumption page. All detailed properties below are ',(0,o.kt)("inlineCode",{parentName:"p"},"Boolean"),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"enabled"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},'Enable the Library "Add To Library" banner or not. If the banner is disabled in custom application, the true value wouldn\u2019t take effect.'),(0,o.kt)("li",{parentName:"ul"},"Default value: ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),".")))),(0,o.kt)("h5",{id:"botconsumption"},(0,o.kt)("inlineCode",{parentName:"h5"},"botConsumption")),(0,o.kt)("p",null,"Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"botConsumption")," object to customize UI of the bot consumption page. All detailed properties below are ",(0,o.kt)("inlineCode",{parentName:"p"},"Boolean"),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"snapshot.enabled")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Enable the snapshot panel on the bot consumption page or not."),(0,o.kt)("li",{parentName:"ul"},"Default value: ",(0,o.kt)("inlineCode",{parentName:"li"},"true"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"navigationBar.enabled")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Enable the navigation bar on the bot consumption page or not."),(0,o.kt)("li",{parentName:"ul"},"Default value: ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),".")))),(0,o.kt)("h4",{id:"sample-11"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  placeholder: document.getElementById("container"),\n  customUi: {\n    addToLibraryBanner: {\n      enabled: true,\n    },\n    botConsumption: {\n      snapshot: {\n        enabled: false,\n      },\n      navigationBar: {\n        enabled: true,\n      },\n    },\n  },\n});\n')),(0,o.kt)("h3",{id:"permissions"},(0,o.kt)("inlineCode",{parentName:"h3"},"permissions")),(0,o.kt)("p",null,"Specify the permissions on the embedded bot consumption page."),(0,o.kt)("h4",{id:"required-11"},"Required?"),(0,o.kt)("p",null,"No"),(0,o.kt)("h4",{id:"properties-2"},"Properties"),(0,o.kt)("h5",{id:"allowclipboardwrite"},(0,o.kt)("inlineCode",{parentName:"h5"},"allowClipboardWrite")),(0,o.kt)("p",null,"To grant the \"ClipboardWrite\" permission or not. Could be used to enable the copy functionality on a bot message or not. It's worthy note that the copy functionality also requires the Library server to be HTTPS. If it's an HTTP server, the copy functionality would be disabled, regardless of the value of this flag."),(0,o.kt)("h5",{id:"default-value-11"},"Default value"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h4",{id:"sample-12"},"Sample"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'microstrategy.embeddingContexts.embedBotConsumptionPage({\n  serverUrl: "https://demo.microstrategy.com/MicroStrategyLibrary",\n  projectId: "B19DEDCC11D4E0EFC000EB9495D0F44F",\n  objectId: "D9AB379D11EC92C1D9DC0080EFD415BB",\n  placeholder: document.getElementById("container"),\n  permissions: {\n    allowClipboardWrite: true,\n  },\n});\n')))}m.isMDXComponent=!0}}]);